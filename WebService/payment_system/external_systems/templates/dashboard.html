<html>
<body>
<h1>Main Page</h1>

<h2>All Cards</h2>
<ul>
  {% for card in full_cards %}
  <li>
    {{ card.platform }} – {{ card.card_type }} ({{ card.bank }})<br>
    Card #: {{ card.card_number }}<br>
    Balance: {{ card.balance }} | Cashback: {{ card.cashback }} | Commission: {{ card.commission }}%
  </li>
  {% endfor %}
</ul>

<h2>Lookup Destination</h2>
<form method="post">
  {% csrf_token %}
  {{ dest_form.destination_card_number.label_tag }}
  {{ dest_form.destination_card_number }}
  {% if dest_form.errors.destination_card_number %}
    <p style="color:red">{{ dest_form.errors.destination_card_number.0 }}</p>
  {% endif %}
  <button type="submit" name="action" value="continue">Continue</button>
</form>

{% if dest_selected %}
  <h2>Select Source & Transfer</h2>
  {% if message %}<p>{{ message }}</p>{% endif %}
  <form method="post">
    {% csrf_token %}
    <input type="hidden" name="destination_card_number"
           value="{{ dest_form.destination_card_number.value }}">
    <ul>
      {% for card in source_cards %}
      <li>
        <label>
          <input type="radio" name="source_card_number"
                 value="{{ card.card_number }}" required>
          {{ card.platform }} – {{ card.card_type }} ({{ card.bank }}) –
          Card #: {{ card.card_number }} –
          Balance: {{ card.balance }} –
          Commission: {{ card.commission }}% –
          Cashback: {{ card.cashback }}
        </label>
      </li>
      {% endfor %}
    </ul>
    <p>Amount: <input type="number" name="amount" step="0.01" required></p>
    <button type="submit" name="action" value="transfer">Transfer</button>
  </form>
{% endif %}

<a href="{% url 'logout' %}">Logout</a>
</body>
</html>